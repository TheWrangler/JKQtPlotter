<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JKQTPlotter: Example (JKQTPlotter): Simple math image plot</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JKQTPlotter
   </div>
   <div id="projectbrief">an extensive Qt4/Qt5 Plotter framework (including a fast variant and a LaTeX equation renderer!), written fully in C/C++ and without external dependencies</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d8/deb/a03246.html','../../');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example (<a class="el" href="../../d0/d2b/a02833.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)This class is a QW...">JKQTPlotter</a>): Simple math image plot </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This project (see <code>./examples/simpletest_imageplot/</code>) simply creates a <a class="el" href="../../d0/d2b/a02833.html" title="plotter widget for scientific plots (uses JKQTBasePlotter to do the actual drawing)This class is a QW...">JKQTPlotter</a> widget (as a new window) and adds a color-coded image plot of a mathematical function (here the Airy disk). The image is stored as a simple C-array in row-major ordering and then copied into a single column of the internal datasdtore (<a class="el" href="../../dd/d4a/a02761.html" title="class to plot an image from an 2-dimensional array of values">JKQTPMathImage</a> could be directly used without the internal datastore). This very simple interface can also be used to interface with many common image processing libraries, like CImg or OpenCV.</p>
<p>The source code of the main application is (see <a href="../../../simpletest_imageplot/jkqtplotter_simpletest_imageplot.cpp"><code>jkqtplotter_simpletest_imageplot.cpp</code></a>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QApplication&gt;</span></div><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dd/d8d/a01667.html">jkqtplotter/jkqtplotter.h</a>&quot;</span></div><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../d0/dc0/a01652.html">jkqtplotter/jkqtpgraphsimage.h</a>&quot;</span></div><div class="line"></div><div class="line"><span class="preprocessor">#ifndef M_PI</span></div><div class="line"><span class="preprocessor">#define M_PI 3.14159265358979323846</span></div><div class="line"><span class="preprocessor">#endif</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div><div class="line">{</div><div class="line">    QApplication app(argc, argv);</div><div class="line"></div><div class="line">    <a class="code" href="../../d0/d2b/a02833.html">JKQTPlotter</a> plot;</div><div class="line">    <span class="comment">// 1. create a plotter window and get a pointer to the internal datastore (for convenience)</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#ae4f1ab656cfc37b600667853a1b23686">getPlotter</a>()-&gt;<a class="code" href="../../dc/de1/a02493.html#a4706bf608223fd2ffbf71afb5b9e5d4f">setUseAntiAliasingForGraphs</a>(<span class="keyword">true</span>); <span class="comment">// nicer (but slower) plotting</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#ae4f1ab656cfc37b600667853a1b23686">getPlotter</a>()-&gt;<a class="code" href="../../dc/de1/a02493.html#a1b6db291aaa5416b7c5d38fce8641557">setUseAntiAliasingForSystem</a>(<span class="keyword">true</span>); <span class="comment">// nicer (but slower) plotting</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#ae4f1ab656cfc37b600667853a1b23686">getPlotter</a>()-&gt;<a class="code" href="../../dc/de1/a02493.html#a9ab1d12d8da8b47f93657ffccaa9cff2">setUseAntiAliasingForText</a>(<span class="keyword">true</span>); <span class="comment">// nicer (but slower) text rendering</span></div><div class="line">    <a class="code" href="../../d6/d28/a02509.html">JKQTPDatastore</a>* ds=plot.<a class="code" href="../../d0/d2b/a02833.html#a98d17ba77ef46da2b7d7f24637f12842">getDatastore</a>();</div><div class="line"></div><div class="line">    <span class="comment">// 2. now we create data for the charts (taken from https://commons.wikimedia.org/wiki/File:Energiemix_Deutschland.svg)</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> NX=100; <span class="comment">// image dimension in x-direction [pixels]</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> NY=100; <span class="comment">// image dimension in x-direction [pixels]</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> dx=1e-2; <span class="comment">// size of a pixel in x-direction [micrometers]</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> dy=1e-2; <span class="comment">// size of a pixel in x-direction [micrometers]</span></div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> w=static_cast&lt;double&gt;(NX)*dx;</div><div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> h=static_cast&lt;double&gt;(NY)*dy;</div><div class="line">    <span class="keywordtype">double</span> airydisk[NX*NY]; <span class="comment">// row-major image</span></div><div class="line"></div><div class="line">    <span class="comment">// 2.1 Parameters for airy disk plot (see https://en.wikipedia.org/wiki/Airy_disk)</span></div><div class="line">    <span class="keywordtype">double</span> NA=1.1; <span class="comment">// numerical aperture of lens</span></div><div class="line">    <span class="keywordtype">double</span> wavelength=488e-3; <span class="comment">// wavelength of the light [micrometers]</span></div><div class="line"></div><div class="line">    <span class="comment">// 2.2 calculate image of airy disk in a row-major array</span></div><div class="line">    <span class="keywordtype">double</span> x, y=-h/2.0;</div><div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iy=0; iy&lt;NY; iy++ ) {</div><div class="line">        x=-w/2.0;</div><div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ix=0; ix&lt;NX; ix++ ) {</div><div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> r=sqrt(x*x+y*y);</div><div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> v=2.0*M_PI*NA*r/wavelength;</div><div class="line">            airydisk[iy*NX+ix] = pow(2.0*j1(v)/v, 2);</div><div class="line">            x+=dx;</div><div class="line">        }</div><div class="line">        y+=dy;</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// 3. make data available to JKQTPlotter by adding it to the internal datastore.</span></div><div class="line">    <span class="comment">//    In this step the contents of C-array airydisk is copied into a column</span></div><div class="line">    <span class="comment">//    of the datastore in row-major order</span></div><div class="line">    <span class="keywordtype">size_t</span> cAiryDisk=ds-&gt;<a class="code" href="../../d6/d28/a02509.html#a5d6d25b41a6ef3d1df072ea219924f19">addCopiedImageAsColumn</a>(airydisk, NX, NY, <span class="stringliteral">&quot;imagedata&quot;</span>);</div><div class="line"></div><div class="line">  </div><div class="line">    <span class="comment">// 4. create a graph (JKQTPColumnMathImage) with the column created above as data</span></div><div class="line">    <span class="comment">//    The data is color-coded with the color-palette JKQTPMathImageMATLAB</span></div><div class="line">    <span class="comment">//    the converted range of data is determined automatically because setAutoImageRange(true)</span></div><div class="line">    <a class="code" href="../../d1/da5/a02769.html">JKQTPColumnMathImage</a>* graph=<span class="keyword">new</span> <a class="code" href="../../d1/da5/a02769.html">JKQTPColumnMathImage</a>(&amp;plot);</div><div class="line">    graph-&gt;<a class="code" href="../../dd/d4a/a02761.html#a12c1ea21eed55cd34899742f15b17362">setTitle</a>(<span class="stringliteral">&quot;&quot;</span>);</div><div class="line">    <span class="comment">// image column with the data</span></div><div class="line">    graph-&gt;<a class="code" href="../../d1/da5/a02769.html#a64d8443502002fe626cbe55799f3c198">setImageColumn</a>(cAiryDisk);</div><div class="line">    <span class="comment">// set size of the data (the datastore does not contain this info, as it only manages 1D columns of data and this is used to assume a row-major ordering</span></div><div class="line">    graph-&gt;<a class="code" href="../../d9/d93/a02753.html#a6e5ecc0f89c578ceb6c2dd271a16d1af">setNx</a>(NX);</div><div class="line">    graph-&gt;<a class="code" href="../../d9/d93/a02753.html#a86dacd0436a8258e6855f5856450f846">setNy</a>(NY);</div><div class="line">    <span class="comment">// where does the image start in the plot, given in plot-axis-coordinates (bottom-left corner)</span></div><div class="line">    graph-&gt;<a class="code" href="../../df/d40/a02749.html#a6faa565abe89ef8bb91a91e3c59061ae">setX</a>(-w/2.0);</div><div class="line">    graph-&gt;<a class="code" href="../../df/d40/a02749.html#a303ad9c73dfd5aba70cc639d589efa9d">setY</a>(-h/2.0);</div><div class="line">    <span class="comment">// width and height of the image in plot-axis-coordinates</span></div><div class="line">    graph-&gt;<a class="code" href="../../df/d40/a02749.html#a39a3d55e730d824f97a140f1397f0855">setWidth</a>(w);</div><div class="line">    graph-&gt;<a class="code" href="../../df/d40/a02749.html#a4391bc7bd8af8351f70596233e4519b7">setHeight</a>(h);</div><div class="line">    <span class="comment">// color-map is &quot;MATLAB&quot;</span></div><div class="line">    graph-&gt;<a class="code" href="../../dd/d4a/a02761.html#ad61bf349bb6e222b77c26eabb0c8e523">setPalette</a>(<a class="code" href="../../d3/dac/a01777.html#ggaae2f1de8b42bb1734243b4201f4aa72da1879a8e269bb9bff662d7b246f75b474">JKQTPMathImageMATLAB</a>);</div><div class="line">    <span class="comment">// get coordinate axis of color-bar and set its label</span></div><div class="line">    graph-&gt;<a class="code" href="../../dd/d4a/a02761.html#ae7375516f563603f19806415c1bf4a66">getColorBarRightAxis</a>()-&gt;<a class="code" href="../../d4/d73/a02465.html#acdc1fc8ea9ef5a37ddf4f617e2b835b3">setAxisLabel</a>(<span class="stringliteral">&quot;light intensity [A.U.]&quot;</span>);</div><div class="line">    <span class="comment">// determine min/max of data automatically and use it to set the range of the color-scale</span></div><div class="line">    graph-&gt;<a class="code" href="../../dd/d4a/a02761.html#a2759e218f0fe10d4da45e854350c2cf6">setAutoImageRange</a>(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">  </div><div class="line">  </div><div class="line">    <span class="comment">// 5. add the graphs to the plot, so it is actually displayed</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#a63a54c5342d664c35ffb3d532ba26b99">addGraph</a>(graph);</div><div class="line"></div><div class="line">  </div><div class="line">    <span class="comment">// 6. set axis labels</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#a8571dee6731963903967ef91c1c632c4">getXAxis</a>()-&gt;<a class="code" href="../../d4/d73/a02465.html#acdc1fc8ea9ef5a37ddf4f617e2b835b3">setAxisLabel</a>(<span class="stringliteral">&quot;x [{\\mu}m]&quot;</span>);</div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#aa59a12b5cfb966a6847d8ca207542bd0">getYAxis</a>()-&gt;<a class="code" href="../../d4/d73/a02465.html#acdc1fc8ea9ef5a37ddf4f617e2b835b3">setAxisLabel</a>(<span class="stringliteral">&quot;y [{\\mu}m]&quot;</span>);</div><div class="line"></div><div class="line">  </div><div class="line">    <span class="comment">// 7. fix axis and plot aspect ratio to 1</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#ae4f1ab656cfc37b600667853a1b23686">getPlotter</a>()-&gt;<a class="code" href="../../dc/de1/a02493.html#a1360fa41c72a05e4142527e3322e2d61">setMaintainAspectRatio</a>(<span class="keyword">true</span>);</div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#ae4f1ab656cfc37b600667853a1b23686">getPlotter</a>()-&gt;<a class="code" href="../../dc/de1/a02493.html#a3fdaa585b8b1a150321b19742091ddaa">setMaintainAxisAspectRatio</a>(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">    <span class="comment">// 8 autoscale the plot so the graph is contained</span></div><div class="line">    plot.<a class="code" href="../../d0/d2b/a02833.html#a0ed800587c1f3f5ab36dd5422c101e28">zoomToFit</a>();</div><div class="line"></div><div class="line">    <span class="comment">// show plotter and make it a decent size</span></div><div class="line">    plot.show();</div><div class="line">    plot.resize(600,600);</div><div class="line">    plot.setWindowTitle(<span class="stringliteral">&quot;JKQTPColumnMathImage&quot;</span>);</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keywordflow">return</span> app.exec();</div><div class="line">}</div></div><!-- fragment --><p> The result looks like this:</p>
<img src="../../../../screenshots/jkqtplotter_simpletest_imageplot.png" alt="jkqtplotter_simpletest_imageplot" class="inline"/>
<p>There are several ways to modify the plot:</p><ol type="1">
<li>You can set the color scale manually (here 0..2), by using ``` graph-&gt;setAutoImageRange(false); graph-&gt;setImageMin(0); graph-&gt;setImageMax(2); <div class="fragment"><div class="line">instead of </div></div><!-- fragment --> graph-&gt;setAutoImageRange(true); <div class="fragment"><div class="line">from above. The result will look like this:&lt;br&gt;</div><div class="line">![jkqtplotter_simpletest_imageplot__scale02](../../screenshots/jkqtplotter_simpletest_imageplot__scale02.png)&lt;br&gt;</div><div class="line">Note how the color scale is not used completely, because data really only scales between 0 and 1.</div><div class="line">2. If you set the color-range to 0.1 .. 0.8 with</div></div><!-- fragment --> graph-&gt;setAutoImageRange(false); graph-&gt;setImageMin(0.1); graph-&gt;setImageMax(0.8); ``` Then there will be datapoints above or below the range of the colorscale. The default behaviour of the graph is to use the first color of the palette for every pixel with a value below the minimum (here 0.1) and the last color in the palette for every pixel with a value above the maximum.<br />
 <img src="../../../../screenshots/jkqtplotter_simpletest_imageplot__smallscalelimitcolor.png" alt="jkqtplotter_simpletest_imageplot__smallscalelimitcolor" class="inline"/>
<br />
 You can change this behaviour by <code>setRangeMinFailAction(),setRangeMaxFailAction()</code> with one of these parameters:<ul>
<li><code>JKQTPMathImageLastPaletteColor</code>: the default behaviour explained above</li>
<li><code>JKQTPMathImageGivenColor</code>: use a color set by <code>setRangeMinFailColor(),setRangeMaxFailColor()</code> (here e.g. black for min and grey for max)<br />
 <img src="../../../../screenshots/jkqtplotter_simpletest_imageplot__smallscalecolor.png" alt="jkqtplotter_simpletest_imageplot__smallscalecolor" class="inline"/>
</li>
<li><code>JKQTPMathImageTransparent</code>: draw pixels transparent<br />
 <img src="../../../../screenshots/jkqtplotter_simpletest_imageplot__smallscaletransparent.png" alt="jkqtplotter_simpletest_imageplot__smallscaletransparent" class="inline"/>
</li>
</ul>
</li>
</ol>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d5/de7/a03234.html">Example &amp; Tutorial Projects</a></li>
    <li class="footer">Generated on Tue Jan 29 2019 11:30:10 for JKQTPlotter by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
